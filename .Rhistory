depth = depth[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs = vafs[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs.auto = vafs[,which(!grepl('chrM', colnames(vafs)))]
vafs.auto[vafs.auto < 10] = 0
depth = depth[rownames(vafs.auto),]
depth = depth[, colnames(vafs.auto)]
vafs.auto[is.na(depth) | depth == 0] = -1
variant.df = data.frame(vmr = -log10(apply(vafs.auto, 2, FUN = function(x){mean(x) / var(x)})),
vaf = apply(vafs.auto, 2, FUN = function(x){median(x[which(x != 0)])}),
freq = apply(vafs.auto, 2, FUN = function(x){length(which(x != 0))}))
vafs.auto = vafs.auto[intersect(rownames(vafs.auto), rownames(CLL.mito.vaf)),]
vafs.mito = 100*CLL.mito.vaf[rownames(vafs.auto),]
vafs = cbind(vafs.auto, vafs.mito)
relevant.mutations = unique(c(rownames(variant.df)[which(variant.df$vmr > 0 & variant.df$vaf > 25)],
colnames(vafs.mito)))
vafs = dplyr::bind_rows(vafs.1, vafs.2)
depth = dplyr::bind_rows(depth.1, depth.2)
cells.2.donor = annotation2$bc[which(annotation2$annotation == 'CLL3.donor' & annotation2$bc %in% rownames(vafs))]
cells.2.recipient = annotation2$bc[which(annotation2$annotation == 'CLL3.recipient' & annotation2$bc %in% rownames(vafs))]
cells.1.CLL = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster == 'CLL')])]
cells.1.immune = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster %ni% c('CLL', 'Cluster 6'))])]
CLL.auto = c('B3GALT1:chr2:168726231:C/T', 'GRIK5:chr19:42546856:C/T',
'TINAG:chr6:54191662:G/A', 'UPP2:chr2:158974339:G/A', 'PELI2:chr14:56645144:A/T', 'ALDH1A1:chr9:75543910:G/A', 'RELA:chr11:65429479:C/G',
'U2AF2:chr19:56172500:T/A', 'CR1:chr1:207791577:G/A', 'chr4:155163826:A/T', 'ABCB5:chr7:20782612:T/C', 'ASL:chr7:65554306:A/G',
'MME:chr3:154866416:G/T', 'KCNK13:chr14:90650709:G/A')
CLL.mito = c('2332C>T', '5979G>A')
depth = depth[c(cells.1.CLL, cells.1.immune, cells.2.recipient, cells.2.donor),]
vafs = vafs[c(cells.1.CLL, cells.1.immune, cells.2.recipient, cells.2.donor),]
vafs.auto = vafs[,c(CLL.auto)]
vafs.auto[vafs.auto < 10] = 0
depth = depth[rownames(vafs.auto),]
depth = depth[, colnames(vafs.auto)]
vafs.auto[is.na(depth) | depth == 0] = NA
vafs.auto = vafs.auto[complete.cases(vafs.auto),]
vafs.auto = vafs.auto[intersect(rownames(vafs.auto), rownames(CLL.mito.vaf)),]
# plot from 0 to 10%
vafs.mito = 1000*CLL.mito.vaf[rownames(vafs.auto),]
vafs = cbind(vafs.auto, vafs.mito)
cells.2.donor = annotation2$bc[which(annotation2$annotation == 'CLL3.donor' & annotation2$bc %in% rownames(vafs))]
cells.2.recipient = annotation2$bc[which(annotation2$annotation == 'CLL3.recipient' & annotation2$bc %in% rownames(vafs))]
cells.1.CLL = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster == 'CLL')])]
cells.1.immune = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster %ni% c('CLL', 'Cluster 6'))])]
cluster.information.1 = cluster_relevant_mutations(t(vafs[cells.1.CLL, c(CLL.auto, CLL.mito)]), dims = 2, k_param = 5)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`MME:chr3:154866416:G/T`, y=`KCNK13:chr14:90650709:G/A`), color='blue', size=0.5) +
scale_x_continuous('% MMEK525N', limits = c(0,100)) +
scale_y_continuous('% KCKN13V197I', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_MME_KCKN13.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`MME:chr3:154866416:G/T`, y=`KCNK13:chr14:90650709:G/A`), color='firebrick', size=0.5) +
scale_x_continuous('% MMEK525N', limits = c(0,100)) +
scale_y_continuous('% KCKN13V197I', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_MME_KCKN13.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`2332C>T`/10, y=`5979G>A`/10), color='blue', size=0.5) +
scale_x_continuous('% 2332C>T', limits = c(0,100)) +
scale_y_continuous('% 5979G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_2332C>T_5979G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`2332C>T`/10, y=`5979G>A`/10), color='firebrick', size=0.5) +
scale_x_continuous('% 2332C>T', limits = c(0,100)) +
scale_y_continuous('% 5979G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_2332C>T_5979G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`MME:chr3:154866416:G/T`, y=`5979G>A`/10), color='blue', size=0.5) +
scale_x_continuous('% MMEK525N', limits = c(0,100)) +
scale_y_continuous('% 5979G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_MME_5979G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`MME:chr3:154866416:G/T`, y=`5979G>A`/10), color='firebrick', size=0.5) +
scale_x_continuous('% MMEK525N', limits = c(0,100)) +
scale_y_continuous('% 5979G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_MME_5979G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`MME:chr3:154866416:G/T`, y=`2332C>T`/10), color='blue', size=0.5) +
scale_x_continuous('% MMEK525N', limits = c(0,100)) +
scale_y_continuous('% 2332C>T', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_MME_2332C>T.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`MME:chr3:154866416:G/T`, y=`2332C>T`/10), color='firebrick', size=0.5) +
scale_x_continuous('% MMEK525N', limits = c(0,100)) +
scale_y_continuous('% 2332C>T', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_MME_2332C>T.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`ASL:chr7:65554306:A/G`, y=`2332C>T`/10), color='blue', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% 2332C>T', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_ASL_2332C>T.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`ASL:chr7:65554306:A/G`, y=`2332C>T`/10), color='firebrick', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% 2332C>T', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_ASL_2332C>T.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`ASL:chr7:65554306:A/G`, y=`5979G>A`/10), color='blue', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% 5979G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_ASL_5979G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`ASL:chr7:65554306:A/G`, y=`5979G>A`/10), color='firebrick', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% 5979G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_ASL_5979G>A.svg', width = 1.1, height = 1.1)
library(ComplexHeatmap)
library(dplyr)
library(ggplot2)
library(Seurat)
library(Signac)
`%ni%` <- Negate(`%in%`)
col_fun = circlize::colorRamp2(breaks = c(-1,seq(0,100,100/8)), colors = c('grey', BuenColors::jdb_palette(name = 'solar_rojos')))
# call mtDNA mutations using mgatk
CLL1.mito = ReadMGATK('./data/coevolution/CLL1.hg38.mgatk/')
colnames(CLL1.mito$counts) = gsub(paste0('CLL1#', colnames(CLL1.mito$counts)), pattern = '-1', replacement = '')
rownames(CLL1.mito$depth) = gsub(paste0('CLL1#', rownames(CLL1.mito$depth)), pattern = '-1', replacement = '')
CLL4.mito = ReadMGATK('./data/coevolution/CLL4.mgatk/')
colnames(CLL4.mito$counts) = gsub(paste0('CLL4#', colnames(CLL4.mito$counts)), pattern = '-1', replacement = '')
rownames(CLL4.mito$depth) = gsub(paste0('CLL4#', rownames(CLL4.mito$depth)), pattern = '-1', replacement = '')
CLL.mito = CLL1.mito
CLL.mito$depth = rbind(CLL.mito$depth, CLL4.mito$depth)
CLL.mito$counts = cbind(CLL.mito$counts, CLL4.mito$counts)
CLL.so <- CreateAssayObject(counts = CLL.mito$counts)
CLL.mgatk = CreateSeuratObject(counts = CLL.so, project = 'CLL.mgatk', assay = 'mito')
rm(CLL.so)
CLL.mgatk = AddMetaData(CLL.mgatk, metadata = CLL.mito$depth, col.name = 'mtDNA_depth')
CLL.mgatk <- AlleleFreq(object = CLL.mgatk, variants = c('3526G>A', '3532A>C','3830T>C', '930G>A', '7205C>T', '2623A>G',
'9554G>A', '13030T>C', '13471G>A', '9540C>T'),
assay = "mito")
CLL.mito.vaf = as.data.frame(t(as.data.frame(GetAssayData(CLL.mgatk[["alleles"]]))))
so.12 = readRDS('./data/coevolution/objects/20220504_CLL34_filtered.rds')
vafs.1 = as.data.frame(data.table::fread('./data/coevolution/CLL1.whitelist/AF.csv'))
vafs.1$Barcode = gsub(paste0('CLL1#',vafs.1$Barcode), pattern = '-1', replacement = '')
rownames(vafs.1) = vafs.1$Barcode
vafs.1 = vafs.1[,-c(1,2)]
vafs.2 = as.data.frame(data.table::fread('./data/coevolution/CLL4.whitelist/AF.csv'))
vafs.2$Barcode = gsub(paste0('CLL4#',vafs.2$Barcode), pattern = '-1', replacement = '')
rownames(vafs.2) = vafs.2$Barcode
vafs.2 = vafs.2[,-c(1,2)]
depth.1 = as.data.frame(data.table::fread('./data/coevolution/CLL1.whitelist/DP.csv'))
depth.1$Barcode = gsub(paste0('CLL1#',depth.1$Barcode), pattern = '-1', replacement = '')
rownames(depth.1) = depth.1$Barcode
depth.1 = depth.1[,-c(1,2)]
depth.2 = as.data.frame(data.table::fread('./data/coevolution/CLL4.whitelist/DP.csv'))
depth.2$Barcode = gsub(paste0('CLL4#',depth.2$Barcode), pattern = '-1', replacement = '')
rownames(depth.2) = depth.2$Barcode
depth.2 = depth.2[,-c(1,2)]
vafs = dplyr::bind_rows(vafs.1, vafs.2)
depth = dplyr::bind_rows(depth.1, depth.2)
annotation1 = read.csv2('./data/coevolution/CLL1/20220506_deconvolution.csv', row.names = 1)
annotation4 = read.csv2('./data/coevolution/CLL4/20220506_deconvolution.csv', row.names = 1)
annotation1$bc = gsub(annotation1$bc, pattern = '-1', replacement = '')
annotation4$bc = gsub(annotation4$bc, pattern = '-1', replacement = '')
cells.donor.2 = annotation1$bc[which(annotation1$annotation == 'CLL2.donor' & annotation1$bc %in% rownames(vafs))]
cells.recipient.2 = annotation1$bc[which(annotation1$annotation == 'CLL2.recipient' & annotation1$bc %in% rownames(vafs))]
cells.1.CLL = colnames(so.12)[which(colnames(so.12) %in% annotation4$bc[which(annotation4$annotation == 'CLL2.recipient')] &
so.12$manual.cluster %in% c('CLL', 'Cluster 6'))]
cells.1.immune = colnames(so.12)[which(colnames(so.12) %in% annotation4$bc[which(annotation4$annotation == 'CLL2.recipient')] &
so.12$manual.cluster %ni% c('CLL', 'Cluster 6'))]
cells.1 = c(cells.1.CLL, cells.1.immune)
depth = depth[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs = vafs[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs.auto = vafs[,which(!grepl('chrM', colnames(vafs)))]
vafs.auto[vafs.auto < 10] = 0
depth = depth[rownames(vafs.auto),]
depth = depth[, colnames(vafs.auto)]
vafs.auto[is.na(depth) | depth == 0] = -1
variant.df = data.frame(vmr = -log10(apply(vafs.auto, 2, FUN = function(x){mean(x) / var(x)})),
vaf = apply(vafs.auto, 2, FUN = function(x){median(x[which(x != 0)])}),
freq = apply(vafs.auto, 2, FUN = function(x){length(which(x != 0))}))
vafs.auto = vafs.auto[intersect(rownames(vafs.auto), rownames(CLL.mito.vaf)),]
vafs.mito = 100*CLL.mito.vaf[rownames(vafs.auto),]
vafs = cbind(vafs.auto, vafs.mito)
relevant.mutations = unique(c(rownames(variant.df)[which(variant.df$vmr > 0 & variant.df$vaf > 25)],
colnames(vafs.mito)))
### make curated heatmap with custom ordering
source('./R/20200328_mtscatac_seq.R')
donor.auto = c()
donor.mito = c()
recipient.auto = c('ESRRG:chr1:216880662:G/A')
CLL.common.auto = c('ERICH3:chr1:75102115:G/C', 'PLEC:chr8:144994678:CCT/C',  'WASF3:chr13:27255288:G/T', 'DNAJB7:chr22:41257549:A/C',
'BPIFA2:chr20:31761967:G/C', 'ZNF292:chr6:87967797:CA/C', 'DCBLD2:chr3:98600507:G/A', 'CHD7:chr8:61765460:A/AGCT')
CLL.common.mito = c()
CLL.auto = c('PKDREJ:chr22:46658486:A/C', 'TP53:chr17:7577124:C/T')
CLL.mito = c( '3830T>C', '3526G>A', '930G>A', '2623A>G', '9554G>A')
vafs = dplyr::bind_rows(vafs.1, vafs.2)
depth = dplyr::bind_rows(depth.1, depth.2)
depth = depth[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs = vafs[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs.auto = vafs[,c(CLL.auto, CLL.common.auto)]
vafs.auto[vafs.auto < 10] = 0
depth = depth[rownames(vafs.auto),]
depth = depth[, colnames(vafs.auto)]
vafs.auto[is.na(depth) | depth == 0] = NA
vafs.auto = vafs.auto[complete.cases(vafs.auto),]
vafs.auto = vafs.auto[intersect(rownames(vafs.auto), rownames(CLL.mito.vaf)),]
# plot from 0 to 10%
vafs.mito = 1000*CLL.mito.vaf[rownames(vafs.auto),]
vafs = cbind(vafs.auto, vafs.mito)
cells.2.donor = annotation1$bc[which(annotation1$annotation == 'CLL2.donor' & annotation1$bc %in% rownames(vafs))]
cells.2.recipient = annotation1$bc[which(annotation1$annotation == 'CLL2.recipient' & annotation1$bc %in% rownames(vafs))]
cells.1.CLL = annotation4$bc[which(annotation4$annotation == 'CLL2.recipient' & annotation4$bc %in% rownames(vafs) &
annotation4$bc %in% colnames(so.12)[which(so.12$manual.cluster == 'CLL')])]
cells.1.immune = annotation4$bc[which(annotation4$annotation == 'CLL2.recipient' & annotation4$bc %in% rownames(vafs) &
annotation4$bc %in% colnames(so.12)[which(so.12$manual.cluster %ni% c('CLL', 'Cluster 6'))])]
cluster.information.1 = cluster_relevant_mutations(t(vafs[cells.1.CLL, c(CLL.auto, CLL.mito)]), dims = 2, k_param = 5)
cells.1.CLL = colnames(cluster.information.1[[1]])
cells.1.CLL = cells.1.CLL[order(vafs[cells.1.CLL,'TP53:chr17:7577124:C/T'], decreasing = T)]
cluster.information.2 = cluster_relevant_mutations(t(vafs[cells.2.recipient, c(CLL.auto, CLL.mito)]), dims = 2, k_param = 5)
cells.2.recipient = colnames(cluster.information.2[[1]])
cells.2.recipient = cells.2.recipient[order(vafs[cells.2.recipient,'TP53:chr17:7577124:C/T'], decreasing = T)]
cells.1.immune = names(sort(so.12$manual.cluster[cells.1.immune]))
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`TP53:chr17:7577124:C/T`, y=`2623A>G`/10), color='blue', size=0.5) +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% 2623A>G', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_TP53_2623A>G.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`TP53:chr17:7577124:C/T`, y=`2623A>G`/10), color='firebrick', size=0.5) +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% 2623A>G', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_TP53_2623A>G.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`PKDREJ:chr22:46658486:A/C`, y=`2623A>G`/10), color='blue', size=0.5) +
scale_x_continuous('% PKDREJV245P', limits = c(0,100)) +
scale_y_continuous('% 2623A>G', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_PKDREJ_2623A>G.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`PKDREJ:chr22:46658486:A/C`, y=`2623A>G`/10), color='firebrick', size=0.5) +
scale_x_continuous('% PKDREJV245P', limits = c(0,100)) +
scale_y_continuous('% 2623A>G', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_PKDREJ_2623A>G.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`TP53:chr17:7577124:C/T`, y=`3526G>A`/10), color='blue', size=0.5) +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% 3526G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_TP53_3526G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`TP53:chr17:7577124:C/T`, y=`3526G>A`/10), color='firebrick', size=0.5) +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% 3526G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_TP53_3526G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`PKDREJ:chr22:46658486:A/C`, y=`3526G>A`/10), color='blue', size=0.5) +
scale_x_continuous('% PKDREJV245P', limits = c(0,100)) +
scale_y_continuous('% 3526G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_PKDREJ_3526G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`PKDREJ:chr22:46658486:A/C`, y=`3526G>A`/10), color='firebrick', size=0.5) +
scale_x_continuous('% PKDREJV245P', limits = c(0,100)) +
scale_y_continuous('% 3526G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_PKDREJ_3526G>A.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`TP53:chr17:7577124:C/T`, y=`3830T>C`/10), color='blue', size=0.5) +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% 3830T>C', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_TP53_3830T>C.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`TP53:chr17:7577124:C/T`, y=`3830T>C`/10), color='firebrick', size=0.5) +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% 3830T>C', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_TP53_3830T>C.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`PKDREJ:chr22:46658486:A/C`, y=`3830T>C`/10), color='blue', size=0.5) +
scale_x_continuous('% PKDREJV245P', limits = c(0,100)) +
scale_y_continuous('% 3830T>C', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_PKDREJ_3830T>C.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`PKDREJ:chr22:46658486:A/C`, y=`3830T>C`/10), color='firebrick', size=0.5) +
scale_x_continuous('% PKDREJV245P', limits = c(0,100)) +
scale_y_continuous('% 3830T>C', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_PKDREJ_3830T>C.svg', width = 1.1, height = 1.1)
ggplot(vafs[cells.1.CLL,], aes(x=`TP53:chr17:7577124:C/T`, y=`PKDREJ:chr22:46658486:A/C`)) +
geom_point(size=0.5, color='blue') +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% PKDREJV245P', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_TP53_PKDREJ.svg', width = 1.1, height = 1.1)
ggplot(vafs[cells.2.recipient,], aes(x=`TP53:chr17:7577124:C/T`, y=`PKDREJ:chr22:46658486:A/C`)) +
geom_point(size=0.5, color='firebrick') +
scale_x_continuous('% TP53V272L', limits = c(0,100)) +
scale_y_continuous('% PKDREJV245P', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_TP53_PKDREJ.svg', width = 1.1, height = 1.1)
ggplot(vafs[cells.1.CLL,], aes(x=`3830T>C`/10, y=`3526G>A`/10)) +
geom_point(size=0.5, color='blue') +
scale_x_continuous('% 3830T>C', limits = c(0,100)) +
scale_y_continuous('% 3526G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_pre_FCR_3830T>C_3526G>A.svg', width = 1.1, height = 1.1)
ggplot(vafs[cells.2.recipient,], aes(x=`3830T>C`/10, y=`3526G>A`/10)) +
geom_point(size=0.5, color='firebrick') +
scale_x_continuous('% 3830T>C', limits = c(0,100)) +
scale_y_continuous('% 3526G>A', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL6/plots/20230427_CLL6_post_HSCT_3830T>C_3526G>A.svg', width = 1.1, height = 1.1)
# call mtDNA mutations using mgatk
CLL2.mito = ReadMGATK('./data/coevolution/CLL2.hg38.mgatk/')
colnames(CLL2.mito$counts) = gsub(paste0('CLL2#', colnames(CLL2.mito$counts)), pattern = '-1', replacement = '')
rownames(CLL2.mito$depth) = gsub(paste0('CLL2#', rownames(CLL2.mito$depth)), pattern = '-1', replacement = '')
CLL3.mito = ReadMGATK('./data/coevolution/CLL3.mgatk/')
colnames(CLL3.mito$counts) = gsub(paste0('CLL3#', colnames(CLL3.mito$counts)), pattern = '-1', replacement = '')
rownames(CLL3.mito$depth) = gsub(paste0('CLL3#', rownames(CLL3.mito$depth)), pattern = '-1', replacement = '')
CLL.mito = CLL2.mito
CLL.mito$depth = rbind(CLL.mito$depth, CLL3.mito$depth)
CLL.mito$counts = cbind(CLL.mito$counts, CLL3.mito$counts)
CLL.so <- CreateAssayObject(counts = CLL.mito$counts)
CLL.mgatk = CreateSeuratObject(counts = CLL.so, project = 'CLL.mgatk', assay = 'mito')
rm(CLL.so)
CLL.mgatk = AddMetaData(CLL.mgatk, metadata = CLL.mito$depth, col.name = 'mtDNA_depth')
CLL.mgatk <- AlleleFreq(object = CLL.mgatk, variants = c('2332C>T', '5979G>A', '12685T>C', '2776G>A', '4412G>A',
'5458T>C', '11886T>C', '13676A>G', '1489G>A', '11700T>C',
'1263G>A', '279T>C'),
assay = "mito")
CLL.mito.vaf = as.data.frame(t(as.data.frame(GetAssayData(CLL.mgatk[["alleles"]]))))
so.12 = readRDS('./data/coevolution/objects/20220504_CLL34_filtered.rds')
vafs.1 = as.data.frame(data.table::fread('./data/coevolution/CLL2.whitelist/AF.csv'))
vafs.1$Barcode = gsub(paste0('CLL2#',vafs.1$Barcode), pattern = '-1', replacement = '')
rownames(vafs.1) = vafs.1$Barcode
vafs.1 = vafs.1[,-c(1,2)]
vafs.2 = as.data.frame(data.table::fread('./data/coevolution/CLL3.whitelist/AF.csv'))
vafs.2$Barcode = gsub(paste0('CLL3#',vafs.2$Barcode), pattern = '-1', replacement = '')
rownames(vafs.2) = vafs.2$Barcode
vafs.2 = vafs.2[,-c(1,2)]
depth.1 = as.data.frame(data.table::fread('./data/coevolution/CLL2.whitelist/DP.csv'))
depth.1$Barcode = gsub(paste0('CLL2#',depth.1$Barcode), pattern = '-1', replacement = '')
rownames(depth.1) = depth.1$Barcode
depth.1 = depth.1[,-c(1,2)]
depth.2 = as.data.frame(data.table::fread('./data/coevolution/CLL3.whitelist/DP.csv'))
depth.2$Barcode = gsub(paste0('CLL3#',depth.2$Barcode), pattern = '-1', replacement = '')
rownames(depth.2) = depth.2$Barcode
depth.2 = depth.2[,-c(1,2)]
vafs = dplyr::bind_rows(vafs.1, vafs.2)
depth = dplyr::bind_rows(depth.1, depth.2)
annotation2 = read.csv2('./data/coevolution/CLL2/20220506_deconvolution.csv', row.names = 1)
annotation3 = read.csv2('./data/coevolution/CLL3/20220506_deconvolution.csv', row.names = 1)
annotation2$bc = gsub(annotation2$bc, pattern = '-1', replacement = '')
annotation3$bc = gsub(annotation3$bc, pattern = '-1', replacement = '')
cells.donor.2 = gsub(annotation2$bc[which(annotation2$annotation == 'CLL3.donor' & annotation2$bc %in% rownames(vafs))],
pattern = '-1', replacement = '')
cells.recipient.2 = gsub(annotation2$bc[which(annotation2$annotation == 'CLL3.recipient' & annotation2$bc %in% rownames(vafs))],
pattern = '-1', replacement = '')
cells.1 = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs))]
depth = depth[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs = vafs[c(cells.1, cells.donor.2, cells.recipient.2),]
vafs.auto = vafs[,which(!grepl('chrM', colnames(vafs)))]
vafs.auto[vafs.auto < 10] = 0
depth = depth[rownames(vafs.auto),]
depth = depth[, colnames(vafs.auto)]
vafs.auto[is.na(depth) | depth == 0] = -1
variant.df = data.frame(vmr = -log10(apply(vafs.auto, 2, FUN = function(x){mean(x) / var(x)})),
vaf = apply(vafs.auto, 2, FUN = function(x){median(x[which(x != 0)])}),
freq = apply(vafs.auto, 2, FUN = function(x){length(which(x != 0))}))
vafs.auto = vafs.auto[intersect(rownames(vafs.auto), rownames(CLL.mito.vaf)),]
vafs.mito = 100*CLL.mito.vaf[rownames(vafs.auto),]
vafs = cbind(vafs.auto, vafs.mito)
relevant.mutations = unique(c(rownames(variant.df)[which(variant.df$vmr > 0 & variant.df$vaf > 25)],
colnames(vafs.mito)))
### make curated heatmap with custom ordering
source('./R/20200328_mtscatac_seq.R')
vafs = dplyr::bind_rows(vafs.1, vafs.2)
depth = dplyr::bind_rows(depth.1, depth.2)
cells.2.donor = annotation2$bc[which(annotation2$annotation == 'CLL3.donor' & annotation2$bc %in% rownames(vafs))]
cells.2.recipient = annotation2$bc[which(annotation2$annotation == 'CLL3.recipient' & annotation2$bc %in% rownames(vafs))]
cells.1.CLL = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster == 'CLL')])]
cells.1.immune = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster %ni% c('CLL', 'Cluster 6'))])]
CLL.auto = c('B3GALT1:chr2:168726231:C/T', 'GRIK5:chr19:42546856:C/T',
'TINAG:chr6:54191662:G/A', 'UPP2:chr2:158974339:G/A', 'PELI2:chr14:56645144:A/T', 'ALDH1A1:chr9:75543910:G/A', 'RELA:chr11:65429479:C/G',
'U2AF2:chr19:56172500:T/A', 'CR1:chr1:207791577:G/A', 'chr4:155163826:A/T', 'ABCB5:chr7:20782612:T/C', 'ASL:chr7:65554306:A/G',
'MME:chr3:154866416:G/T', 'KCNK13:chr14:90650709:G/A')
CLL.mito = c('2332C>T', '5979G>A')
depth = depth[c(cells.1.CLL, cells.1.immune, cells.2.recipient, cells.2.donor),]
vafs = vafs[c(cells.1.CLL, cells.1.immune, cells.2.recipient, cells.2.donor),]
vafs.auto = vafs[,c(CLL.auto)]
vafs.auto[vafs.auto < 10] = 0
depth = depth[rownames(vafs.auto),]
depth = depth[, colnames(vafs.auto)]
vafs.auto[is.na(depth) | depth == 0] = NA
vafs.auto = vafs.auto[complete.cases(vafs.auto),]
vafs.auto = vafs.auto[intersect(rownames(vafs.auto), rownames(CLL.mito.vaf)),]
# plot from 0 to 10%
vafs.mito = 1000*CLL.mito.vaf[rownames(vafs.auto),]
vafs = cbind(vafs.auto, vafs.mito)
cells.2.donor = annotation2$bc[which(annotation2$annotation == 'CLL3.donor' & annotation2$bc %in% rownames(vafs))]
cells.2.recipient = annotation2$bc[which(annotation2$annotation == 'CLL3.recipient' & annotation2$bc %in% rownames(vafs))]
cells.1.CLL = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster == 'CLL')])]
cells.1.immune = annotation3$bc[which(annotation3$annotation == 'CLL3.recipient' & annotation3$bc %in% rownames(vafs) &
annotation3$bc %in% colnames(so.12)[which(so.12$manual.cluster %ni% c('CLL', 'Cluster 6'))])]
cluster.information.1 = cluster_relevant_mutations(t(vafs[cells.1.CLL, c(CLL.auto, CLL.mito)]), dims = 2, k_param = 5)
cells.1.CLL = colnames(cluster.information.1[[1]])
#cells.1.CLL = cells.1.CLL[order(vafs[cells.1.CLL,'ASL:chr7:65554385:C/T'], decreasing = T)]
cluster.information.2 = cluster_relevant_mutations(t(vafs[cells.2.recipient, c(CLL.auto, CLL.mito)]), dims = 2, k_param = 5)
cells.2.recipient = colnames(cluster.information.2[[1]])
#cells.2.recipient = cells.2.recipient[order(vafs[cells.2.recipient,'ASL:chr7:65554385:C/T'], decreasing = T)]
cells.1.immune = names(sort(so.12$manual.cluster[cells.1.immune]))
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`ASL:chr7:65554306:A/G`, y=`KCNK13:chr14:90650709:G/A`), color='blue', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% KCKN13V197I', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_ASL_KCNK13.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`ASL:chr7:65554306:A/G`, y=`KCNK13:chr14:90650709:G/A`), color='firebrick', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% KCKN13V197I', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_ASL_KCNK13.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.1.CLL,], aes(x=`ASL:chr7:65554306:A/G`, y=`MME:chr3:154866416:G/T`), color='blue', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% MMEK525N', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_pre_FCR_ASL_MME.svg', width = 1.1, height = 1.1)
ggplot() +
geom_point(data=vafs[cells.2.recipient,], aes(x=`ASL:chr7:65554306:A/G`, y=`MME:chr3:154866416:G/T`), color='firebrick', size=0.5) +
scale_x_continuous('% ASLY321C', limits = c(0,100)) +
scale_y_continuous('% MMEK525N', limits = c(0,100)) +
theme_classic() +
theme(axis.text = element_text('Arial', size=8, color='black'),
axis.title = element_text('Arial', size=8, color='black'))
ggsave('./figure_coevolution/CLL/figures/CLL5/plots/20230427_CLL5_post_HSCT_ASL_MME.svg', width = 1.1, height = 1.1)
